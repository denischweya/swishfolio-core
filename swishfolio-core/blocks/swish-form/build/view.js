!function(){"use strict";function e(){document.querySelectorAll(".sfcore-swish-form__form").forEach(e=>{e.addEventListener("submit",s)})}async function s(e){e.preventDefault();const s=e.target,r=s.dataset.formId,t=s.dataset.formType,n=s.dataset.successMessage,i=s.dataset.errorMessage,c=s.querySelector(".sfcore-swish-form__button"),a=c.querySelector(".sfcore-swish-form__button-text"),f=c.querySelector(".sfcore-swish-form__button-loading"),l=s.querySelector(".sfcore-swish-form__messages");l.textContent="",l.className="sfcore-swish-form__messages",function(e){e.querySelectorAll(".sfcore-swish-form__field-error").forEach(e=>{e.textContent=""});e.querySelectorAll(".has-error").forEach(e=>{e.classList.remove("has-error")})}(s);const d=s.querySelector('input[name="hp_field"]');if(d&&d.value)o(l,n,"success");else if(s.checkValidity()){c.disabled=!0,a.style.display="none",f.style.display="inline-flex";try{const e=new FormData(s),c={formId:r,formType:t,nonce:e.get("swish_form_nonce"),fields:{}};for(const[s,o]of e.entries())if(s.startsWith("fields[")){const e=s.match(/fields\[(.+?)\]/)[1];c.fields[e]=o}const a=await fetch(swishFormData.restUrl+"swishfolio/v1/forms/submit",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":swishFormData.restNonce},body:JSON.stringify(c)}),f=await a.json();f.success?(o(l,n,"success"),s.reset()):(f.errors&&function(e,s){for(const[o,r]of Object.entries(s)){const s=e.querySelector(`[name="fields[${o}]"]`);if(s){const e=s.closest(".sfcore-swish-form__field"),o=e?.querySelector(".sfcore-swish-form__field-error");o&&(o.textContent=r),s.classList.add("has-error")}}}(s,f.errors),o(l,f.message||i,"error"))}catch(e){console.error("Form submission error:",e),o(l,i,"error")}finally{c.disabled=!1,a.style.display="inline",f.style.display="none"}}else s.reportValidity()}function o(e,s,o){e.textContent=s,e.className=`sfcore-swish-form__messages sfcore-swish-form__messages--${o}`,e.scrollIntoView({behavior:"smooth",block:"nearest"})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}();